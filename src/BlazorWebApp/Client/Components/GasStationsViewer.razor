<style>
    .mud-table-row.cursor-pointer.selected {
        background-color: #1E88E5 !important;
    }

        .mud-table-row.cursor-pointer.selected > td {
            color: white !important;
        }

            .mud-table-row.cursor-pointer.selected > td .mud-input {
                color: white !important;
            }
</style>

<MudDataGrid @ref="DataGridRef"
             ColumnResizeMode="ResizeMode.None"
             Dense
             Filterable
             FilterCaseSensitivity="DataGridFilterCaseSensitivity.Ignore"
             FilterMode="DataGridFilterMode.ColumnFilterRow"
             Height="450"
             Hover
             Items="GasStationItems"
             Loading="IsLoading"
             RowsPerPage="10"
             SelectedItemChanged="OnSelectedItemChanged"
             SortMode="SortMode.Single"
             T="Libs.GasStationPrices.ViewModels.GasStationModel">

    <ColGroup>
        <col style="width: 50%;" />
        @foreach (var item in Libs.GasStationPrices.Models.Minetur.ProductoPetrolifero.All)
        {
            var IsHidden = !PetroleumProductsSelectedIds.Contains(item.IdProducto);

            <col hidden="@IsHidden" />
        }
    </ColGroup>

    <Columns>
        <PropertyColumn Property="@(x => x.RotuloTrimed)" Filterable="true" Sortable="true" Title="Rótulo">
            <FilterTemplate>
                <MudIconButton Icon="@RotuloFilterIcon" OnClick="@(() => IsRotuloFilterOpen = true)" Size="Size.Small" />
                <MudOverlay OnClick="@(() => IsRotuloFilterOpen = false)" Visible="IsRotuloFilterOpen" />
                <MudPopover AnchorOrigin="Origin.BottomCenter" Open="IsRotuloFilterOpen" TransformOrigin="Origin.TopCenter">
                    <MudStack Spacing="0">
                        <MudCheckBox Label="Select All" Size="Size.Small" T="bool" Value="IsRotuloFilterAllSelected" ValueChanged="RotuloFilterSelectAll" />
                        <MudStack Spacing="0" Style="overflow-y: auto; max-height: 250px">
                            @foreach (var item in context.Items.Select(x => x.RotuloTrimed).Distinct().Order())
                            {
                                <MudCheckBox Label="@($"{item}")"
                                             Size="Size.Small"
                                             T="bool"
                                             Value="@RotuloFilterSelectedItems.Contains(item)"
                                             ValueChanged="@((value) => RotuloFilterSelectedChanged(value, item))" />
                            }
                        </MudStack>
                        <MudStack Row Class="justify-md-space-evenly">
                            <MudButton OnClick="@(() => RotuloFilterClearAsync(context))">Clear</MudButton>
                            <MudButton Color="Color.Primary" OnClick="@(() => RotuloFilterApplyAsync(context))">Filter</MudButton>
                        </MudStack>
                    </MudStack>
                </MudPopover>
            </FilterTemplate>
        </PropertyColumn>

        @foreach (var item in Libs.GasStationPrices.Models.Minetur.ProductoPetrolifero.All)
        {
            var IsHidden = !PetroleumProductsSelectedIds.Contains(item.IdProducto);
            <TemplateColumn CellClass="mud-table-cell-align-right"
                            Filterable="false"
                            Hidden="IsHidden"
                            SortBy="@(x => x.Prices.FirstOrDefault(y => y.Product.IdProducto == item.IdProducto)?.Price ?? null)"
                            Sortable="true"
                            Title="@item.Abreviatura">
                <CellTemplate>
                    @(context.Item.Prices.FirstOrDefault(y => y.Product.IdProducto == item.IdProducto)?.Price ?? null)
                </CellTemplate>
            </TemplateColumn>
        }
    </Columns>

    <LoadingContent>
        Loading Content ....
    </LoadingContent>

    <NoRecordsContent>
        No data
    </NoRecordsContent>

    <PagerContent>
        <MudDataGridPager Class="pa-4"
                          ShowNavigation="true"
                          ShowPageNumber="true">
        </MudDataGridPager>
    </PagerContent>

</MudDataGrid>
