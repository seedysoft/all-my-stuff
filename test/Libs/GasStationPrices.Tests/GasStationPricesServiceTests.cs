using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Seedysoft.Libs.Infrastructure.Extensions;
using Xunit;

namespace Seedysoft.Libs.GasStationPrices.Tests;

public sealed class GasStationPricesServiceTests : Infrastructure.Tests.TestClassBase
{
    private readonly Services.GasStationPricesService GasStationPricesService = default!;

    public GasStationPricesServiceTests() : base()
    {
        HostApplicationBuilder appBuilder = new();
        _ = appBuilder.AddAllMyDependencies();
        ServiceProvider serviceProvider = appBuilder.Services.BuildServiceProvider();

        GasStationPricesService = serviceProvider.GetRequiredService<Services.GasStationPricesService>();
    }

    //[Fact]
    //public async Task GetPetroleumProductsAsyncTest()
    //{
    //    IEnumerable<Core.Json.Minetur.ProductoPetrolifero> Res =
    //        await GasStationPricesService.GetPetroleumProductsAsync(CancellationToken.None);

    //    Assert.True(Res.Any());
    //}

    [Fact]
    public async Task GetNearGasStationsAsyncTest()
    {
        string SamplePolyline = "gjoaGtjjUNIZMhAg@h@U\\M^OpCiADAXMVI\\M\\MNGl@WXKZOr@YNGZMZMl@Sb@O^Ib@EJ?v@D~@Vr@`@DFdBzAtCfCTRDDz@v@d@`@p@p@Z`@@R@FLNPBHC@CXTx@r@vApAfA~@TRr@n@bA|@\\^n@n@t@n@`@^b@^vBlBb@^f@f@PPj@v@x@`B\\dAh@pBBJn@`CFf@GZ@XJTNH\\x@H|@L|AF|BEdN@xB?J@TDpGV|NFhCmAvAEPT|D\\hGNnCXvEJ~AB\\@JMPAZ@DUb@]V]LKB_@L_@LQ}BMo@NODWEWOOA?O@MNAh@?BDLNDJCLn@P|BFjBCTAXMLo@Ea@g@QkA@UJYrA_@dCu@dBi@z@UNCn@IFAd@EH?RAt@@P@f@DVDlAZJDVJv@`@PLfA|@r@z@R\\h@`ATf@HPNb@FRh@nB\\nAd@fBJ`@lBjHbBpGNf@v@vC`@~ARp@ZnAT|@d@fBf@fBBHt@tBx@rAb@f@NLPNPNdAf@p@Rz@J~@@XArFa@PCbBO|BSJ?ZA~@@xANZHh@PXJFB^RVN\\VJHXTbAlA@@`@n@b@r@v@|Ah@~@hAbB|@~@RR`At@TJPLNFd@TbBl@rDl@TBh@J`BXvDdA`Bb@tA\\vCt@VFH@FBnBd@XHfAZfCr@NTl@Xb@j@\\l@fB`EVd@h@`A`@j@`AnA`@^J@~BpCr@z@HJ\\`@RXTZ`AxAnA|BnA~Cr@xB^rA`@~Ap@~CJf@FRBJrApGNr@P~@r@dEjAzGJt@Hd@d@bDNfAL`Al@rERfBPvA`AfJZnDl@bI`@zFB^^bGRpCP`C@J@N@J@Jd@fFp@~G\\xCjAtJNdAFZ|AjK`@|Bp@tDf@zCPfA~AfK\\dCz@nHZnCp@lHCb@TvE@x@@pBE~CGlAEn@CRATYjCW|Ai@dCa@|As@tB]x@c@`AsA~BcBxB]^}@|@cBpA_CtAmCrAaCpA_Aj@sA`A_ClBiCjCEBiD`EEF_CpCGFo@t@yB~Bg@f@uCfCaEvCuErCkCzAiJrF{EzCmFtDkA~@i@^yBhBeGlFmEjE_HxH_E`FaAtAmA`BeCrDgBnCk@|@m@`A{D|Gc@x@wB~Dk@dAyBhEq@pA]n@_BtCs@tAkAvB{BbEcA`BuBzCk@v@sAbBs@z@wB|BwAtAcA`A_@\\aDjCoBtAeBlAeEfCi@Z{HlEs@`@s@`@eB|@{BpAq@^iBdAwBnAg@X}G|DwAx@e@VkH~DYPaAj@iBbASJ[PsAv@i@VwDxBIDcH`EiChBgAz@cAz@eCxBiAdAgAvAwAjBaCxDU\\MVu@zAMVuBfFo@fB]hAs@pCu@`DCJw@rEKr@i@dFYzEKhCK~GAzA@fD@j@NvIJrE@NJlCh@pVDfEB~A@dB@xIA`BAZAbAClCUdHKvCi@fIw@hI{@zGe@|Cg@xCMr@yAjHi@dCeAzDc@xAOh@Y`A[`AsC`Ic@hASf@eAbCIL}@xBmBhEgClFWh@qCvFiAzBQ`@kAdCe@bAEHYp@sA~CkC`HwAhEg@bB_@xAoA~Fy@hFe@xDe@`GQ~DMpFAlED~FRxF^dGz@dKzGjq@`AxJdAnMf@jIDr@RpFNhK?jDArBMbH]xHe@zGw@xHy@bGy@zEqAjGoAhF}BvHOh@gBtFqDtJoAlDkGtOiAhD{ApFw@nDw@vE]hCGt@W`DOhCEtAG|EA`@FnGJ|CFhA\\jF`A|JBTFl@LpAP`Bt@vHNpBB\\Dz@FhAHxBFdD?v@@|A?bBKhEUfEK|@Cb@Gj@C^Kx@_@pCM~@}@pEmAxEsAjEwB|Fe@nAkDlJMZi@bB_AvCg@lB[nA_AlE]vBWfBi@bFYzDO`EErCA~A@dN@fK?nCAtAA|AErFK`EGnB_@hIMfBCb@AJ_@jFcArJsAbK{AvIaB|H_BtGYhAgCvIoGlSaClI{@hDuArGyAlHi@bD]zBAH}@dHeDr[m@|Fa@hDw@|F[tBw@rEMp@e@bCi@lCwB|Iq@dCkCbJeB~Fs@jC_AlDw@fDgBxISdACJc@xCu@|Fo@hH[dFYdHG~F?^@dGPpJ@p@ZbMB~EEnDCbAOfE[pEk@rF]bCuAfHcA~D{BzGgDxIuEtL}@bCy@vBuApDaAhCsBfGUv@aAhEaA|FG^CVe@zD?DOvBO|CKnDAhA?fAArAJpETzEBRb@lEDf@d@`DN~@h@lCp@~CbAnEBHLj@~BhLRjAnBbLpBbNvAtLfAhLp@rIhDvi@Dj@BX@`@l@hJHrA\\vFr@dL~@bO\\pFFhAV~DVfEVzDDl@|A~VN~BB`@HxAl@jMVfHVnLHfLCpH?NAlAQjKYjJe@~JGx@YnEMrAw@`Jy@zHmB~NEXG^gBdMaKns@uAdL_@`DKx@_@xDUpB{AvQw@fKY`FS~DAJKrBo@hP]zLCjAWjPIxRB~MDrEBdG@xMAfEGlKGhFCvA?L?JAn@GzC]xMg@~Mw@bP_A~NGp@Er@aApLeBpQkDv[_@|Da@tEq@|Jc@jJYnKI`I?nKH`J^xMb@nJHjA`AnMlDfa@l@`I`@vGRtEH`CFhBFpDBjBDjHAx@?fAAfCC~ASdJ]pIm@~I[vDI|@Kv@AJu@rGeAhHWbBWvAaAfFKh@qBpIe@jBOn@kAdEYbAmArDWx@eCxGg@nAaA`CkAtCgAhCe@fA]x@gDdIsCrHoBbGoBhHyAzGqAnHw@|Fi@|EMtAYvD[lGCp@SlJC`DA|BDrFBpA@l@JjDf@|Ij@dHt@rGzAxJfAlGrCbPvAjJv@xGt@jI^dGNhDHzBFhCHjEDrL?~\\HhKJ~GD~A^`Kx@`N|@`Kt@tGzAzKtAjIfAnGhExUbBzKh@~Db@lDzAfNxAdOfB`RhBhRBd@r@tIv@rL`AdRTrFPtFVfKNvINzP@bOGfLA~AOjKU|J]xKSxEOnDSpDgAdRkBv[s@|Pc@fKCh@IzBY|GIvBOnDAb@MpBWpGM~CKrBEjAC`@U`GObDGdAS`EQtDI~Bu@|PmAjZMbECdCErD?lB?^HlHJtEV~Fl@bIFt@HdA`@rDXvB`B~JzBtKzAhHl@tCz@hEx@dE|@zFNz@hA~HTdBF~@P`BV|BVrC?D`@dFJxAd@vHNpCn@~NDt@f@lLN`DTzDz@rKPjBj@jFHp@lArJFh@dDjU|@fG|BpP~BlPdBtLb@xClFn_@f@lDpAnLXbDl@lJDl@Z`HNdEJlG?P@x@BbHGzKAn@EtEUlNIzH@`HHvKF|CFfA^lI`@lHNtBPdCRpBZzCTnBRzA^~Cn@~ErArH~AjH`BtGlBlHxB~HRp@x@bD~A|FHZBJBHd@hBt@|CvBzIfDtOXzA|@bFLl@x@tE~A|Jr@dFhAfHdCxOpA`Hx@|D^|A|AfGV|@jBtG~FhRRp@f@|AhFjPf@zAbBnF|C|JhEzNV`Az@nDt@hC|DfPt@~C|@`EhC`M`AxE~@`FtAxHV`BNp@Ln@l@tDlAfIvAhJt@dElApIF^tDpV|A|If@`DrCrNfAdF`@`BxCtLfAbEh@lBpFxQpDbLhAdDl@`B~IdVxCfIjL~ZN^N\\jA~CvCtItAjEzCxKzBnKn@nD|@bFjBtNr@`I\\pEn@jMh@lQNzGXlJTrGZpGv@tKn@fH~@hJTjB^nEXfCb@tEThBFj@fBdStAjQpAdWNfENnGBp@@n@L`G@rDHnFBnC?hBBjGAvE?r@EpGCzAAjCIfHC`DQlN?BCbDAj@AV?VKzLI`K?P?J?@ElG?nDAhH?`A@`HBbDRjQd@fSBx@x@zSn@nLj@hJnBjXZnDF`AnA|OlAxOt@xI`@rFfAvOnA|RfApURbETfG`@jQTdPHlUMbWWtOOrG{@bVeA`TInA{AbUiDde@_C~ZyAdUg@fKi@rNqBzv@i@pQMnCa@rJw@|Na@fGw@xK}AxPwBjRmDvX}H|h@mEd[mCnTs@tGYhCk@`GqAhOkAxPe@fIa@lIUtFe@~OWtOKjHEpJAdGAlJJt^JfDDpFBdEBlc@@bHAzUEtHE~EEpCo@~Wc@jM_@pIS`Ee@nIy@jLk@jHQlBs@rHO`B_AbHUtB}A|NkDbWcB|Kw@dEoEjXWtASrAShA{@pFuDxVi@tDe@~Dy@|GiAvJw@jIGh@Ef@Gb@Ej@E`@Cb@CRATe@zHGfAEz@A^Cj@ExBSlIGfEAjBAdK@xE?NNxIDlCLpDVhHBf@Bj@?Jh@jJLnBx@lKr@jJxCr\\d@nFrAhRv@lOf@lOx@`^RxGv@x^RfJTvV@n@BpL?tCA`BCnIWhT]zNk@vN}@dQg@nI{@lN_Etl@y@hNMzB{@rU?JCv@IpCM`HMtLCjQDnNDfIRhWJnI?f@?nBDbE@t@FbFDxDCfFMtCCTUbCIn@UjB_@lBI\\G\\Mj@_@pAq@vBIReBbECBGN[l@yP~]cCbFcChFw@fBgBxEQh@y@hCy@xC}@tDYvAa@xBMt@wH`i@wAxJ_AnGsA`IeBxIyBrJmA~Ek@tBENcAjDe@~A_IjVu@|BaDzJeB|FmAfFg@zBGVqAnH_ApHWlC_@xFMzCCbAAt@CnB?tBBzEBj@@j@@b@LxCPdD@J@Jf@tFTtBhAbIxDlTVnA\\jBn@hDj@~CpAdHBLh@xCX|Ap@nEd@bED\\XlDR`DNpDDpBBlB@h@?hEKzEUpFYrEWbDm@bHgCtZcBpS_Db\\m@xGe@lFWhDABs@bK}@xMKnAStBoBtU_AbLAJAJa@|EgApMoDnb@UvCq@pJs@`NYvH_@lRKrFSpJg@pJk@dHc@`Eq@lFIh@uD`WeH|e@}@~FcEbYy@vFE^w@|GYjDSzDK|BAXKjFErFBvFDxDBxD?HA|ICjBChAI`CWtFe@vF[zCEVg@tDgAhGeAvEm@`CW`AGT}DtMgRtn@kEbOsHjV}HhVK^iFnQmFpRwPbk@iJ`[iCtIuC`KiBhHcBdIsAdIy@vGUnB[hDa@tFEn@m@xMKrD}@nZYnJALUrFe@jJU|DStDw@|KMdBWhC}@hJmAnKSbBK`Ag@xDe@dDwAjJuAfIqBzKkD|QyCnOaBnJgArIk@nF_@|EEn@Gv@QdDYdIIvFC~GBdDJbINnGv@j]D~AvBb~@HdEJjDRzM@|FGfFKpEM`CMlCo@xHq@`GUzASvAuApH}@`EsA|EgB|FwAxD{CfIeDvIaElKm@zAiE|K{C~HeDvIWn@kAdDcBnFo@vBsAnFi@dCqAnHa@zCs@zGOxAc@bHUvFK`GCbHH~LBxD@n@NpSRnV?@@tGExHO`GKvBQ`DQnCm@`Gu@xFaA|Fy@`EwA|F{BxHkFdP_AxCqRpl@_@lAIVCFIPsA`EsErN}AzEkDrKc@pAqBhG[dAm@tBc@~AUz@s@zCS|@}@fFEXSpA_@tCIn@g@xF_@fGQ`GCl@AzFB|GB^Bz@NbHJlEDvDDfEAxBAhBAt@MrFa@~GS`CEb@a@`DUjBg@~CkApFoA~EENoAbEwA~DqA`DaA|B_AtBg@fAm@lAWf@}@bBcDpFiA`BcCjD{ElGo@x@kB`CeE~FwBnDuBvDgA|Bs@dBk@xAq@lB_BdFq@~B{B`JcAnEmCjMiAxGSrASpAk@bFSxBe@`IMpFClGF~EVdHj@|HdAjNd@bIVzG@p@LbIAbB?pFIzFOvFC`@k@rLe@lJCbAMdF?XAfGDxCDbCVpFf@jHpA`Pd@zHHtBL~DJ~F@tJ[xb@CtCCnDUfYa@bf@A`MHhIPnHVhGf@vHn@tGFn@|@zGx@jFfAdGtBvJfG|VT`Al@dCVhAf@xBZ~Aj@nChAfGP~@Fd@Fb@n@dEf@dEXxCN`B@LDf@d@lGTjEBj@RpIBxB@tBAhF?j@QvJOpEKlC]fGc@hFo@xGaAvH}@`Ge@lCKl@YxAe@bCS~@s@zCKf@CLsBbIyA|EkDpKg@tACF}GxR{D~KoCrIgBfGqBrHmIf]kBbHwBdHyAbEgBjEyA~CqAbCyBjDiCpDkCxC}BxByCdCaDvByDtBaFpBmEvAkGzA}HvA}SnDiDr@mBb@y@ReEjAgBl@aFjB_A^}Ar@aChAeB|@gCrAmDvB}F`EwFdE}C~BuEpDGD}NdLkIbHyCpCeDjDo@r@iDfEgBdCs@bAuBdDgAjBYh@Wf@a@r@aC|E}@nBwAlDm@~AcAlCmDfKaEjMcApDs@|Cm@xDWrCQlDEpBAz@Ax@ApB@lCBdE@b@?d@BjAB|BDhCBdB?^FjDF~DJhJ?`@HhFBlBBxFAfECPGlAKv@CV]zAk@vAe@x@y@~@w@j@mAf@{AVcABG@oBAa@Ae@CwBKkAMsBW}@OcGoAaAUeASaAOQB}Be@wAWGCGAg\\{GsDk@wD_@}EOuEDaETw@HuBXkBZuAZaAVs@Rw@Tg@PcA^uAj@WJsAl@w@b@OHGBGDcBdA_Al@q@d@m@f@aDlCwCvCo@t@iArAw@`As@dAaCtDkArBsBtDgBdDaI~NgArBg@`AuAfCEFEHCDgRp]eBtCyAzBmChDuBxBoAfAu@n@sD|C{F|E_D|CUVgApAeArAiA~AaF~HmAlBu@jAy@tAwCdEwBfC[\\uAvAYZgB`B}ClCmEtDyB`C{AnBiBvC_B|CcBlEm@jByCxKcA~Cm@xAq@|Ae@bAaBtCqC|DyChEw@pAoAdCq@|Ac@jAy@jCm@zBo@xCo@jD{@~E]bBYhAUx@QT_BvEqA~C]r@{@xAi@~@EFo@bAc@j@UZyAhBcAfAg@f@c@`@}A|AYZ_AhA]b@iA~Ae@t@MLSZgArBKTg@fAYt@KFYl@[V_@L_@E[SSYKi@C]?[BeA@ENs@P_@JIPKZGR@LDXPJPNVLd@DPHHl@dDjAfGDXr@dDz@dEbAtEFd@j@pCl@lCh@fCP|@XpATbA`@`BLh@Nr@J`@\\~AfDzOTb@Nr@VbAJj@Nx@hAnFfEhSpA`GdAbFtAtGXtAfD|OxFhX~@`EnB|GnBzFPh@vBfFpBlE`@v@dB~C~AlClDdF`CzCxNbPzD`FlC`ElApBjAvBzBrElBrExBdGpLn^nCxI`B~FrAxFnArGf@hDz@lHVpCTrCVzDZnGRlDVrFZ~FFjAPrCTdDFv@JdAp@xFfApHNx@~@vEjAbFZfAh@pBhApDz@fC~@dCz@rB`@|@v@`BBHHNBFVh@lC~EbDdF`CbDpKdMpGpHf@l@vAbBjBjCh@v@`BhCxBzD`BbDzEtKhCfGJTJV\\r@n@vAbAtBp@pA^r@LVx@xA^l@xDhGlAfB`CvC`HzHHFNNRNTTLLRRNNZV^\\jBxArAfAn[zTjD`C`KdHhBrAjErDl@h@hElEtDjEb@h@|AtBhC~DlB`D`ExHpGdMf^tr@fHhNnhArxBrMdWvBtE~DtIhFxLpC`H|C~HdHxRp@rBr@vBbCnHlFjQjHvVlLt`@pMjc@tCxIfCxGnCdGtCtFvEdI|JxPpFvJ`DtGhBhEdC~GHRl@hBNd@t@hC^tAf@lBjCdLnI|a@XvAlBfKbAvFvB`NrCjSRfBZlCh@xETlBpAxMj@rGB`@@RD^NdBJ~A@P@JRzCFz@Bh@ZvEBj@@r@VrEFlBJtAN~CP|DfAdYDv@BX@V@XJrBt@~L`@|Fd@|FbAlLJbA@PhBpPpGdh@RvAtAzKTdBjBfO|Eb`@L`A~D~[z@nId@vGZtHNzHBjPDxKB`CHfDXfHXtEHfANdBTvB`A~HlArHfB~Iz@|Dz@bE`AvFf@rDd@fFVlENpG@bDA`A?ZIdEQdE[pEi@xEo@jEm@|C[tAcA|DuAlEeElLqAbEmA|EWlAk@`Do@jEe@tEi@~HEl@gCre@YlFOxCi@jKCd@KlDE~FBzCNpFRxDf@rFl@xEr@~DXpAVjAjAjEfAfD`BfElB~D~ArC|BjDhC~CfFlF`CdCzAtBnAzBp@|Ab@`A\\nAV|@Nj@n@hDJt@NnAJrADt@P|GFdIJdLLzKHhH@dAFpGF~EJpK@`A^x_@DrD?J?J@x@\\~]B~BBrBDdEDbEHpJJdKBbBHzHDrDFvANnCJ`AJ~@^pB`@rBFVBXvBlHH^PdAL~@LdBB|@@j@AbBGlAC\\KdAIr@]dBaBrI}@xFUjBKnAE`@WbCQnB[fDMxAAJAPwAxPe@~EkArIoA|GuAzFQp@uAzEkBnFcBhEe@bAe@bAILs@xAu@tAqA|BEHk@|@uAtBi@v@cDjE{EzFgEnE{@t@IHuBnB{@r@{CbCmCnB{CnB}@h@a@RYR_DbB[Pw@^}CrAiEbBkDdAsE|@uEh@wCNoDBoDKaE_@iCc@_ASuCs@}HmCcD{@wCe@}CSaBEmDJqBR{Cl@WFsA`@oAb@cChAeCzAYRs@j@oAfAqAtAaCvCW\\OVMPKR]j@OV[l@Ub@_@x@_@|@g@nAy@bCoAjFwAnHALu@nEm@dDWnAm@hCSt@W`AOf@IV]jA[~@i@|AeExKIRg@rAINCJUj@s@zBUr@iApEgAhF{CrPqA|FyAjF}A~EaCrH[fAmA~E}@fE}@pGk@nF]fGi@rLUlCY|Bi@|Co@nC}@zCoA`DoAhCsAzBY^QVUXu@|@[\\{AzAWRoAbAiAt@EB[NKE{@^cAZu@PcBHUAe@EEA_@I_@[IWOMSFKRCJ@LFRLFInAQ`CEl@SBMRCZ@DJPLJMvBGz@cAnOK~AYfEOxCE~CJzLIjB[lCeAhHOhAoClR_@jCk@xDi@dEe@dFWnCE`AUjDMtBMnACLmAfKCHKx@E^StA_AtGe@fD[|A[`AWr@Wn@CFKPQUIGOBI?q@DMFKMi@a@GI_@r@Kx@?T?N";
        int MaxDistanceInKm = 50;

        IAsyncEnumerable<ViewModels.GasStationModel> gasStationModels = GasStationPricesService.GetNearGasStationsAsync(SamplePolyline, MaxDistanceInKm);
        await foreach (ViewModels.GasStationModel item in gasStationModels)
        {
            Assert.NotNull(item);
            break;
        }
    }

    //protected override void Dispose(bool disposing) => Dispose();
}
